{% extends './base.html' %}

{% block title %} Deposit Prediction {% endblock %}

{% block body %}

<div class="container text-center" id="depositPredictionPage" style="margin-top: 50px; max-width: 800px;">

    <!-- Main Header -->
    <div class="row">
        <div class="col">
            <h2 class="fw-bold" style="font-size: 2.5rem; color: #4A4EAE; text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);">
                Predict Fixed-Term Deposit Approvals
            </h2>
            <p class="text-muted" style="font-size: 1.2rem; margin-top: 10px;">
                Upload your customer data and let the AI predict whether they will agree to make a fixed-term deposit.
            </p>
        </div>
    </div>

    <!-- Instructions Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="alert alert-info shadow-sm" role="alert" style="border-radius: 15px;">
                <h6 class="fw-bold text-primary">How to Use This Tool</h6>
                <ol style="font-size: 1rem; color: #4A4EAE; text-align: left;">
                    <li>Download the <a href="static/examples/bank_excel.xlsx" style="color: #c1a400;">sample file</a>.</li>
                    <li>Fill in your customer data based on the template.</li>
                    <li>Click on the <strong>Upload Excel File</strong> button and select your file.</li>
                    <li>Press <strong>Start Prediction</strong> to analyze the data.</li>
                    <li>Once the analysis is complete, download the results by clicking <strong>Download Result</strong>.</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- File Upload Section -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card shadow-lg" style="border-radius: 20px; background: linear-gradient(135deg, #4A4EAE, #6C63FF); color: white;">
                <div class="card-body">
                    <h5 class="card-title fw-bold" style="font-size: 1.5rem;">Upload Customer Data</h5>
                    <p class="card-text" style="font-size: 1rem;">
                        Please upload your Excel file containing customer data in the format specified.
                    </p>

                    <div class="form-group mb-4">
                        <button id="uploadButton" class="btn btn-outline-light btn-lg shadow-sm" style="border-radius: 50px; font-weight: bold;">
                            <i class="fas fa-upload"></i> Upload Excel File
                        </button>
                        <input type="file" id="fileInput" style="display: none;" accept=".xlsx, .xls">
                        <div id="fileName" class="mt-3" style="font-size: 1rem;"></div>
                    </div>

                    <button id="submitFile" class="btn btn-warning btn-lg shadow-sm mt-3" style="border-radius: 50px; font-weight: bold;">
                        <i id="loadingIcon" class="fa fa-spinner fa-spin" style="display: none;"></i>
                        Start Prediction
                    </button>
                    <button id="downloadButton" class="btn btn-success btn-lg shadow-sm mt-3" style="display:none; border-radius: 50px; font-weight: bold;">
                        <i class="fas fa-download"></i> Download Result
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sample Data Table -->
    <div class="row mt-5">
        <div class="col-12">
            <h6 class="fw-bold" style="color: #4A4EAE;">Sample Data Format</h6>
            <div class="table-responsive">
                <table class="table table-bordered table-striped shadow-sm" style="background: #F7F7FF; color: #4A4EAE;">
                    <thead class="table-light">
                        <tr>
                            <th>Age</th>
                            <th>Job</th>
                            <th>Marital</th>
                            <th>Education</th>
                            <th>Balance</th>
                            <th>Contact</th>
                            <th>Duration</th>
                            <th>Campaign</th>
                            <th>Pdays</th>
                            <th>Previous</th>
                            <th>Outcome</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>35</td>
                            <td>Technician</td>
                            <td>Married</td>
                            <td>Secondary</td>
                            <td>5000</td>
                            <td>Cellular</td>
                            <td>180</td>
                            <td>2</td>
                            <td>-1</td>
                            <td>0</td>
                            <td>Failure</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Progress Indicator -->
    <div class="row mt-4">
        <div class="col">
            <div id="progressIndicator" style="display: none;">
                <p class="text-muted">Processing your data... This may take a few seconds.</p>
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
            <div id="successMessage" style="display: none; color: #28a745; font-weight: bold;">
                File processed successfully! Download your results below.
            </div>
            <div id="errorMessage" style="display: none; color: #dc3545; font-weight: bold;">
                Error processing the file. Please check the format and try again.
            </div>
        </div>
    </div>

</div>

<script src="{{ url_for('static', filename='js/mass-predictions.js') }}"></script>

{% endblock %}
